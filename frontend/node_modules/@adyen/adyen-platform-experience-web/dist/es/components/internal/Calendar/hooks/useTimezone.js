import { useMemo as c, useState as d, useEffect as g } from "../../../../external/preact/hooks/dist/hooks.module.js";
import { getTimezoneOffsetFromFormattedDateString as p, getGMTSuffixForTimezoneOffset as E } from "../../../../core/Localization/datetime/restamper/utils.js";
import { clock as M } from "../../../../primitives/time/clock/main.js";
import { isWatchlistUnsubscribeToken as l } from "../../../../primitives/reactive/watchlist/main.js";
import _ from "../../../../core/Localization/datetime/restamper/restamper.js";
import { EMPTY_OBJECT as G, EMPTY_ARRAY as O } from "../../../../utils/value/constants.js";
import { boolOrFalse as S } from "../../../../utils/value/bool.js";
const { getTimezoneTime: U, getUsedTimezone: F } = (() => {
  const s = /\d{2}:\d{2}(?=:\d{2}(?:\.\d+)?\s+([AP]M))/i, m = /^GMT|0(?=\d:00)|:00/g, e = _();
  return { getTimezoneTime: (t, T = Date.now()) => {
    e.tz = t;
    const { formatted: o } = e(T), [i = "", f = ""] = (o == null ? void 0 : o.match(s)) ?? O, a = p(o), u = `${i}${f && ` ${f}`}`, z = E(a).replace(m, "");
    return [u, z];
  }, getUsedTimezone: (t) => (e.tz = t, e.tz.current) };
})(), N = ({ timezone: s, withClock: m = !1 } = G) => {
  const e = c(() => S(m), [m]), n = c(() => F(s), [s]), [r, t] = d(Date.now()), [T, o] = c(() => U(n, r), [r, n]);
  return g(() => {
    if (e)
      return M.subscribe((i) => {
        l(i) || t(i.now);
      });
  }, [t, e]), { clockTime: T, GMTOffset: o, timestamp: r, timezone: n };
};
export {
  N as default,
  U as getTimezoneTime,
  F as getUsedTimezone
};
