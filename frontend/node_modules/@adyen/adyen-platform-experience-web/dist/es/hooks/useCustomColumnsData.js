import { useState as l, useCallback as d, useEffect as u } from "../external/preact/hooks/dist/hooks.module.js";
import { isFunction as y } from "../utils/value/is.js";
const w = ({
  records: s,
  hasCustomColumn: e = !1,
  onDataRetrieve: r,
  mergeCustomData: a
}) => {
  const [i, t] = l(s), [n, c] = l(!1), f = d(async () => {
    try {
      if (e && y(r)) {
        const o = await r(s);
        if (Array.isArray(o)) t(a({ records: s, retrievedData: (o == null ? void 0 : o.filter(Boolean)) || [] }));
        else throw new Error("Retrieved data should be an array");
      } else
        t(s);
    } catch (o) {
      t(s), console.error(o);
    } finally {
      c(!1);
    }
  }, [e, r, a, s]);
  return u(() => {
    e && r && c(!0), f();
  }, [e, f, r]), { customRecords: i, loadingCustomRecords: n };
};
export {
  w as useCustomColumnsData
};
